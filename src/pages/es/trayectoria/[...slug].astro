---
import { type CollectionEntry, getCollection } from "astro:content";
import PageLayout from "@layouts/PageLayout.astro";
import TopLayout from "@layouts/TopLayout.astro";
import BottomLayout from "@layouts/BottomLayout.astro";
import { formatDate } from "@lib/utils";

export async function getStaticPaths() {
  const entries = await getCollection("trayectoria");
  return entries.map((entry) => ({
    params: { slug: entry.slug },
    props: entry,
  }));
}

type Props = CollectionEntry<"trayectoria">;
const entry = Astro.props;
const { Content } = await entry.render();
---

<PageLayout title={entry.data.role} description={entry.data.description}>
  <TopLayout>
    <div class="animate">
      <div class="flex items-center gap-1.5 text-sm uppercase opacity-75">
        {formatDate(entry.data.dateStart)} 
        {entry.data.dateEnd ? ` — ${formatDate(entry.data.dateEnd)}` : " — Presente"}
      </div>
      <h1 class="text-3xl font-semibold text-black dark:text-white mt-2">
        {entry.data.role}
      </h1>
      <div class="text-lg font-medium opacity-80">
        {entry.data.company}
      </div>
    </div>
  </TopLayout>

  <BottomLayout>
    <article class="animate">
      <Content />
    </article>
  </BottomLayout>
</PageLayout>