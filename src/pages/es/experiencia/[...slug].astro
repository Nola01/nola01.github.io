---
import { type CollectionEntry, getCollection } from 'astro:content';
import PageLayout from '@layouts/PageLayout.astro';
import Container from "@components/Container.astro";

// 1. Generamos las rutas dinámicas para cada experiencia
export async function getStaticPaths() {
  const experiences = await getCollection('experiencia'); // Asegúrate que en config.ts se llame 'experiencia' o 'work'
  return experiences.map((entry) => ({
    params: { slug: entry.slug },
    props: { entry },
  }));
}

type Props = {
  entry: CollectionEntry<'experiencia'>;
};

const { entry } = Astro.props;
const { Content } = await entry.render();
---

<PageLayout title={entry.data.role} description={entry.data.company}>
  <Container size="md">
    <div class="animate mt-10">
      <div class="mb-10">
        <h1 class="text-3xl font-bold mb-2">{entry.data.role}</h1>
        <p class="text-xl opacity-75">{entry.data.company}</p>
        <div class="text-sm opacity-50 mt-2">
           {entry.data.dateStart} - {entry.data.dateEnd || "Presente"}
        </div>
      </div>
      
      <article class="prose dark:prose-invert max-w-none">
        <Content />
      </article>
      
      <a href="/es/experiencia" class="inline-block mt-10 opacity-50 hover:opacity-100 transition-opacity">
        ← Volver a Experiencia
      </a>
    </div>
  </Container>
</PageLayout>