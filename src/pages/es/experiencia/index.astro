---
import { getCollection } from "astro:content";
import PageLayout from "@layouts/PageLayout.astro";
import Container from "@components/Container.astro";

const collection = (await getCollection("experiencia"))
  .sort((a, b) => new Date(b.data.dateStart).getTime() - new Date(a.data.dateStart).getTime());
---

<PageLayout title="Experiencia" description="Mi trayectoria profesional y académica">
  <Container size="md">
    <div class="space-y-10 pt-32">
      <h1 class="animate font-bold text-3xl">Experiencia</h1>
        
      <ul class="animate flex flex-col gap-8">
        {collection.map((entry) => (
          <li class="relative border-l-2 border-black/10 dark:border-white/10 pl-6 py-2 hover:border-black/50 dark:hover:border-white/50 transition-colors">
            <span class="absolute -left-[9px] top-3 h-4 w-4 rounded-full bg-white dark:bg-black border-2 border-black/50 dark:border-white/50"></span>
            
            <div class="flex flex-col sm:flex-row sm:justify-between sm:items-baseline">
              <h3 class="font-bold text-lg text-black dark:text-white">
                {entry.data.role}
              </h3>
              <span class="text-sm opacity-75 font-mono">
                {entry.data.dateStart} — {entry.data.dateEnd || "Actualidad"}
              </span>
            </div>
            
            <p class="font-medium opacity-90 mt-1">
              {entry.data.company}
            </p>
            
            {/* CAMBIO AQUÍ: Ahora usamos description en lugar de body */}
            <div class="mt-4 text-sm opacity-75 line-clamp-3">
              {entry.data.description}
            </div>

            {entry.data.hasDetail && (
              <a 
                href={`/es/experiencia/${entry.slug}`}
                class="inline-block mt-4 text-sm font-semibold underline decoration-dashed hover:decoration-solid"
              >
                Ver detalles &rarr;
              </a>
            )}
          </li>
        ))}
      </ul>
    </div>
  </Container>
</PageLayout>